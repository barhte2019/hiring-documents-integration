<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
    xmlns:camel="http://camel.apache.org/schema/spring"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="        http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd        http://camel.apache.org/schema/spring http://camel.apache.org/schema/spring/camel-spring.xsd">

  <bean id="googledrive" class="org.apache.camel.component.google.drive.GoogleDriveConfiguration">
    <property name="applicationName" value="NJCamelApp" />
    <property name="clientId" value="893589349320-ie3bck6o8u2an2862e64k5dqd9e1gvrs.apps.googleusercontent.com" />
    <property name="clientSecret" value="Tz_LjkX_hALS4qYfMmCycRsJ"/>
  </bean>

    <!-- Define a traditional camel context here -->
    <camelContext id="camel" xmlns="http://camel.apache.org/schema/spring">
        <propertyPlaceholder id="properties" location="route.properties"/>
        <!-- EXCLUDE-BEGIN -->
        <endpoint id="csv2json" uri="dozer:csv2json2?sourceModel=org.acme.Customer&amp;targetModel=org.globex.Account&amp;marshalId=json&amp;unmarshalId=csv&amp;mappingFile=transformation.xml"/>
        <!-- CSV Input & JSon OutPut DataFormat -->
        <dataFormats>
            <bindy classType="org.acme.Customer" id="csv" type="Csv"/>
            <json id="json" library="Jackson"/>
        </dataFormats>


        <restConfiguration bindingMode="off" component="servlet" contextPath="/rest" apiContextPath="api-doc"/>
        <rest apiDocs="true"
            id="rest-130579d7-1c1b-409c-a496-32d6feb03006" path="/service">
            <post id="32d64e54-9ae4-42d3-b175-9cfd81733379" uri="/offers">
	      <responseMessage code="200" message="The order with the given id"/>
                <to uri="direct:savedoc"/>
            </post>
            <get uri="/offers/{id}">
	      <param name="id" type="path" dataType="int" description="The order id"/>
                <to uri="direct:getdoc"/>
            </get>
        </rest>
        <!--
             Transformation Endpoint doing csv2java conversion
             Step 1 : csv record is converted java using camel bindy
             Step 2 : Dozer transformation of Customer to Account
             Step 3 : Java to Json conversion using json jackson
        -->
        <route id="_route1" streamCache="true">
            <!-- Save documents to a local directory -->
            <from id="_from1" uri="direct:savedoc"/>
            <log loggingLevel="INFO" message="received content: ${body}"/>
            <to uri="file:{{fileOutput}}?fileName=offer-${random(10,100)}.txt" />
<!--             <setBody> -->
<!--                 <simple>${header.CamelFileName}</simple> -->
<!--             </setBody> -->
<!-- 	    <convertBodyTo type="com.google.api.services.drive.model.File" /> -->
            <to id="_to2" uri="log:gdrive?showAll=true&amp;multiline=true"/>

<!--             <to uri="google-drive://drive-files/insert?inBody=content" /> -->
<!-- 	    <to uri="google-drive://drive-files/insert?content=${body}" /> -->

<!--             <to uri="github:{{githubName}}?username=nandanj&amp;password=*****&amp;repoOwner=nandanj&amp;repoName=docmanager" /> -->

            <setBody>
                <constant>10001</constant>
<!--                 <simple>${body}</simple> -->
            </setBody>
        </route>
        <route id="_route2" streamCache="true">
            <!-- Return the offers -->
            <from id="_from1" uri="direct:getdoc"/>
            <log loggingLevel="INFO" message="received request for docs: ${body}"/>
            <setBody>
<!--                 <simple>${body}</simple> -->
              <constant>"abracadabra"</constant>
            </setBody>
        </route>

        <!-- EXCLUDE-END -->
    </camelContext>
</beans>
